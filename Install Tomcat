#1- First we become the root user and check and install updates:

sudo su -
dnf update

#2- Next we install java package:

dnf install java java-1.8.0-openjdk-devel wget vim -y

#check the version of Java:

java -version

#3- We go to a webpage to get the latest version of Tomcat. We copy the link to the clipboard (core):

#https://dlcdn.apache.org/tomcat/tomcat-10/v10.0.27/bin/apache-tomcat-10.0.27.tar.gz ( Latest version at this time)

#We will paste that later when we use wget to obtain the Tomcat install files.

#4- Before we can get them, we need to ensure we have wget installed. We might as well also install some other software that will get used later. (Note: we use yum install here but could also use dnf install):

yum install wget tree vim -y

#5 -Now we go to the folder we want to extract tomcat into:

cd /opt


#6- Download Tomcat 10

wget https://dlcdn.apache.org/tomcat/tomcat-10/v10.0.27/bin/apache-tomcat-10.0.27.tar.gz

#7- We extract the downloaded file to the current location.

tar -xvf apache-tomcat-10.0.27.tar.gz

#8- Now we use the mv command to change the folder name.

mv apache-tomcat-10.0.27 tomcat10

#9- Now we add the tomcat user as a system account. This means we don't need to do anything special for SELinux, as the system account will allow things to just work as we require. If you don't use a system account, you may need to manually fix things up for use with SELinux:

useradd -r tomcat19

#10- Now we need to change the permissions of the tomcat10 folder so the tomcat19 user can use it:

chown -R tomcat19:tomcat19 /opt/tomcat10

*************Script End***************************

=====================================================================================================================================================================================================================================================================================================

11- Now we need to create the tomcat service. We use an editor like Vim to edit the file tomcat.service.

vim /etc/systemd/system/tomcat.service
##Add these contents to the file:

[Unit]
Description=Apache Tomcat
After=syslog.target network.target

[Service]
Type=forking
User=tomcat19
Group=tomcat19

Environment=CATALINA_PID=/opt/tomcat10/temp/tomcat.pid
Environment=CATALINA_HOME=/opt/tomcat10
Environment=CATALINA_BASE=/opt/tomcat10

ExecStart=/opt/tomcat10/bin/catalina.sh start
ExecStop=/opt/tomcat10/bin/catalina.sh stop

RestartSec=12
Restart=always
[Install]
WantedBy=multi-user.target
:wq ( if we use Vim)


#12- Now we get the system to recognize a new service is available:

systemctl daemon-reload

#13- Now let's start the service, then enable it to autostart and check its status:

systemctl start tomcat.service
systemctl enable tomcat.service
systemctl status tomcat.service

#14- Check that Tomcat works by going to your server's web page on the port 8080:

http://localhost:8080 (web browser)

or using the command:

curl -v localhost:8080

315- Let's add a user for the web console:

cd /opt/tomcat10/
i
Go to the bottom of the file, and put the following just before the <\/tomcat-users> end block. Don't forget to change the YOURPASSWORDHERE to be your own password:

<role rolename="admin-gui,manager-gui"/> 
<user username="admin" password="YOURPASSWORDHERE" roles="admin-gui,manager-gui"/>

16- Now you need to allow access to the management web pages from the internet. If you know what you're doing, you could just allow access from your own IP address, but that is not covered in these written instructions:

vim webapps/manager/META-INF/context.xml
Change the following line:

allow="127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1" />
It should read:

allow="127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1|.*" />

17- Now restart Tomcat:

systemctl restart tomcat
Now go to your Tomcat web console and use the user you created to log in.

You now have a working Tomcat installation.

Thank you.
